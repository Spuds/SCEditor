/* SCEditor v1.5.3 | (C) 2017, Sam Clarke | sceditor.com/license */

!function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var o;void 0!==(o=function(e){"use strict";var t=n(1),o=n(2),i=n(3),r=n(7),a=n(6);t.sceditor=o,o.commands=n(9),o.defaultOptions=n(10),o.RangeHelper=n(4),o.dom=n(5),o.ie=r.ie,o.ios=r.ios,o.isWysiwygSupported=r.isWysiwygSupported,o.regexEscape=a.regex,o.escapeEntities=a.entities,o.escapeUriScheme=a.uriScheme,o.PluginManager=i,o.plugins=i.plugins,t.fn.sceditor=function(e){var n,i,a=[];if((e=e||{}).runWithoutWysiwygSupport||r.isWysiwygSupported)return this.each(function(){n=this.jquery?this:t(this),i=n.data("sceditor"),n.parents(".sceditor-container").length>0||("state"===e?a.push(!!i):"instance"===e?a.push(i):i||new o(this,e))}),a.length?1===a.length?a[0]:t(a):this}}.call(t,n,t,e))&&(e.exports=o)},function(e,t){e.exports=jQuery},function(e,t,n){var o;void 0!==(o=function(e){"use strict";function t(e,t){var n;a.traverse(e,function(e){a.isInline(e,!0)?(n||(n=t[0].createElement("p"),e.insertBefore(n)),3===e.nodeType&&""===e.nodeValue||e.appendChild(n)):n=null},!1,!0)}var o=n(1),i=n(3),r=n(4),a=n(5),s=n(6),l=n(7),c=n(8),u=window,d=document,f=o(u),p=o(d),h=l.ie,g=h&&h<11,m=/^image\/(p?jpe?g|gif|png|bmp)$/i,v=function(e,n){var y,x,b,w,C,S,E,T,k,D,M,R,H,F,N,z,A,O,_,I,B,W,L,V,P,j,q,U,$,Y,K,X,Q,G,J,Z,ee,te,ne,oe,ie,re,ae,se,le,ce,ue,de,fe,pe,he,ge,me,ve,ye,xe,be,we,Ce,Se,Ee,Te,ke,De=this,Me=e.get?e.get(0):e,Re=o(Me),He=[],Fe=[],Ne={},ze=[],Ae={};De.commands=o.extend(!0,{},n.commands||v.commands),De.opts=n=o.extend({},v.defaultOptions,n),j=function(){Re.data("sceditor",De),o.each(n,function(e,t){o.isPlainObject(t)&&(n[e]=o.extend(!0,{},t))}),n.locale&&"en"!==n.locale&&X(),y=o('<div class="sceditor-container" />').insertAfter(Re).css("z-index",n.zIndex),h&&y.addClass("ie ie"+h),I=!!Re.attr("required"),Re.prop("required",!1),K(),ee(),Q(),Y(!!n.startInSourceMode),G(),J(),l.isWysiwygSupported||De.toggleSourceMode(),pe();var e=function(){f.off("load",e),n.autofocus&&ye(),ke(),ge(),de(),N.call("ready")};f.on("load",e),d.readyState&&"complete"===d.readyState&&e()},K=function(){var e=n.plugins;e=e?e.toString().split(","):[],N=new i(De),o.each(e,function(e,t){N.register(o.trim(t))})},X=function(){var e;(H=v.locale[n.locale])||(e=n.locale.split("-"),H=v.locale[e[0]]),H&&H.dateFormat&&(n.dateFormat=H.dateFormat)},Y=function(e){var t;E=o("<textarea></textarea>"),b=o('<iframe frameborder="0" allowfullscreen="true"></iframe>'),e?(y.addClass("sourceMode"),b.hide()):(y.addClass("wysiwygMode"),E.hide()),n.spellcheck||E.attr("spellcheck","false"),"https:"===u.location.protocol&&b.attr("src","javascript:false"),y.append(b).append(E),w=b[0],T=E[0],De.dimensions(n.width||Re.width(),n.height||Re.height()),(t=w.contentDocument).open(),t.write(c("html",{attrs:h?' class="ie ie'+h+'"':"",spellcheck:n.spellcheck?"":'spellcheck="false"',charset:n.charset,style:n.style})),t.close(),S=o(t),C=o(t.body),De.readOnly(!!n.readOnly),(l.ios||l.edge||h)&&(C.height("100%"),h||C.on("touchend",De.focus));var i=Re.attr("tabindex");E.attr("tabindex",i),b.attr("tabindex",i),F=new r(w.contentWindow),De.val(Re.hide().val());var a=n.placeholder||Re.attr("placeholder");a&&(E.placeholder=a,C.attr("placeholder",a))},G=function(){n.autoUpdate&&(C.on("blur",Te),E.on("blur",Te)),null===n.rtl&&(n.rtl="rtl"===E.css("direction")),De.rtl(!!n.rtl),n.autoExpand&&(C[0].addEventListener("load",ke,!0),S.on("input keyup",ke)),n.resizeEnabled&&Z(),y.attr("id",n.id),De.emoticons(n.emoticonsEnabled)},J=function(){var e="onselectionchange"in S?"selectionchange":"keyup focus blur contextmenu mouseup touchend click";p.click(ue),o(Me.form).on("reset",ae).submit(De.updateOriginal),f.on("resize orientationChanged",de),C.keypress(re).keydown(oe).keydown(ie).keyup(ge).blur(Se).keyup(Ee).on("paste",te).on("compositionstart compositionend",le).on(e,me).on("keydown keyup keypress focus blur contextmenu",ce),n.emoticonsCompat&&u.getSelection&&C.keyup(be),C.on("blur",function(){De.val()||C.addClass("placeholder")}),C.on("focus",function(){C.removeClass("placeholder")}),E.blur(Se).keyup(Ee).keydown(oe).on("compositionstart compositionend",le).on("keydown keyup keypress focus blur contextmenu",ce),S.mousedown(se).on(e,me).on("beforedeactivate keyup mouseup",$).keyup(ge).focus(function(){D=null}),y.on("selectionchanged",ve).on("selectionchanged",pe).on("selectionchanged valuechanged nodechanged",ce)},Q=function(){var e,t=De.commands,i=(n.toolbarExclude||"").split(","),r=n.toolbar.split("|");x=o('<div class="sceditor-toolbar" unselectable="on" />'),o.each(r,function(n,r){e=o('<div class="sceditor-group" />'),o.each(r.split(","),function(n,r){var a,s,l=t[r];!l||o.inArray(r,i)>-1||(s=l.shortcut,(a=c("toolbarButton",{name:r,dispName:De._(l.name||l.tooltip||r)},!0)).data("sceditor-txtmode",!!l.txtExec).data("sceditor-wysiwygmode",!!l.exec).toggleClass("disabled",!l.exec).click(function(){var e=o(this);return e.hasClass("disabled")||U(e,l),pe(),!1}),l.tooltip&&a.attr("title",De._(l.tooltip)+(s?" ("+s+")":"")),s&&De.addShortcut(s,r),l.state?Fe.push({name:r,state:l.state}):"string"==typeof l.exec&&Fe.push({name:r,state:l.exec}),e.append(a),Ae[r]=a)}),e[0].firstChild&&x.append(e)}),o(n.toolbarContainer||y).append(x)},Z=function(){var e,t,i,r,a,s,l=o('<div class="sceditor-grip" />'),c=o('<div class="sceditor-resize-cover" />'),d="touchcancel touchend mouseup",f=0,g=0,m=0,v=0,x=0,b=0,w=y.width(),C=y.height(),S=!1,E=De.rtl();e=n.resizeMinHeight||C/1.5,t=n.resizeMaxHeight||2.5*C,i=n.resizeMinWidth||w/1.25,r=n.resizeMaxWidth||1.25*w,a=function(o){"touchmove"===o.type?(o=u.event,m=o.changedTouches[0].pageX,v=o.changedTouches[0].pageY):(m=o.pageX,v=o.pageY);var a=b+(v-g),s=E?x-(m-f):x+(m-f);r>0&&s>r&&(s=r),i>0&&s<i&&(s=i),n.resizeWidth||(s=!1),t>0&&a>t&&(a=t),e>0&&a<e&&(a=e),n.resizeHeight||(a=!1),(s||a)&&(De.dimensions(s,a),h<7&&y.height(a)),o.preventDefault()},s=function(e){S&&(S=!1,c.hide(),y.removeClass("resizing").height("auto"),p.off("touchmove mousemove",a),p.off(d,s),e.preventDefault())},y.append(l),y.append(c.hide()),l.on("touchstart mousedown",function(e){"touchstart"===e.type?(e=u.event,f=e.touches[0].pageX,g=e.touches[0].pageY):(f=e.pageX,g=e.pageY),x=y.width(),b=y.height(),S=!0,y.addClass("resizing"),c.show(),p.on("touchmove mousemove",a),p.on(d,s),h<7&&y.height(b),e.preventDefault()})},ee=function(){var e,t=n.emoticons,i=n.emoticonsRoot;o.isPlainObject(t)&&n.emoticonsEnabled&&o.each(t,function(n,r){o.each(r,function(o,r){i&&(r={url:i+(r.url||r),tooltip:r.tooltip||o},t[n][o]=r),(e=d.createElement("img")).src=r.url||r,He.push(e)})})},ye=function(){var e,t,i=S[0],r=C[0],s=r.firstChild,l=!!n.autofocusEnd;if(y.is(":visible")){if(De.sourceMode())return t=l?T.value.length:0,void(T.setSelectionRange?T.setSelectionRange(t,t):((e=T.createTextRange()).moveEnd("character",t),e.collapse(!1),e.select()));if(a.removeWhiteSpace(r),l)for((s=r.lastChild)||(s=i.createElement("p"),C.append(s));s.lastChild;)s=s.lastChild,!g&&o(s).is("br")&&s.previousSibling&&(s=s.previousSibling);i.createRange?(e=i.createRange(),a.canHaveChildren(s)?e.selectNodeContents(s):(e.setStartBefore(s),l&&e.setStartAfter(s))):(e=r.createTextRange()).moveToElementText(3!==s.nodeType?s:s.parentNode),e.collapse(!l),F.selectRange(e),O=e,l&&(S.scrollTop(r.scrollHeight),C.scrollTop(r.scrollHeight)),De.focus()}},De.readOnly=function(e){return"boolean"!=typeof e?"readonly"===E.attr("readonly"):(C[0].contentEditable=!e,e?E.attr("readonly","readonly"):E.prop("readonly",!1),fe(e),De)},De.rtl=function(e){var t=e?"rtl":"ltr";return"boolean"!=typeof e?"rtl"===E.attr("dir"):(C.attr("dir",t),E.attr("dir",t),y.removeClass("rtl").removeClass("ltr").addClass(t),De)},fe=function(e){var t=De.inSourceMode()?"txtmode":"wysiwygmode";o.each(Ae,function(n,o){!0!==e&&o.data("sceditor-"+t)?o.removeClass("disabled"):o.addClass("disabled")})},De.width=function(e,t){return e||0===e?(De.dimensions(e,null,t),De):y.width()},De.dimensions=function(e,t,o){var i=h<8||d.documentMode<8?2:0;return e=!(!e&&0!==e)&&e,t=!(!t&&0!==t)&&t,!1===e&&!1===t?{width:De.width(),height:De.height()}:(void 0===b.data("outerWidthOffset")&&De.updateStyleCache(),!1!==e&&(!1!==o&&(n.width=e),!1===t&&(t=y.height(),o=!1),y.width(e),e&&e.toString().indexOf("%")>-1&&(e=y.width()),b.width(e-b.data("outerWidthOffset")),E.width(e-E.data("outerWidthOffset")),l.ios&&C&&C.width(e-b.data("outerWidthOffset")-(C.outerWidth(!0)-C.width()))),!1!==t&&(!1!==o&&(n.height=t),t&&t.toString().indexOf("%")>-1&&(t=y.height(t).height(),y.height("auto")),t-=n.toolbarContainer?0:x.outerHeight(!0),b.height(t-b.data("outerHeightOffset")),E.height(t-i-E.data("outerHeightOffset"))),De)},De.updateStyleCache=function(){b.data("outerWidthOffset",b.outerWidth(!0)-b.width()),E.data("outerWidthOffset",E.outerWidth(!0)-E.width()),b.data("outerHeightOffset",b.outerHeight(!0)-b.height()),E.data("outerHeightOffset",E.outerHeight(!0)-E.height())},De.height=function(e,t){return e||0===e?(De.dimensions(null,e,t),De):y.height()},De.maximize=function(e){return void 0===e?y.is(".sceditor-maximize"):((e=!!e)&&(V=f.scrollTop()),o("html, body").toggleClass("sceditor-maximize",e),y.toggleClass("sceditor-maximize",e),De.width(e?"100%":n.width,!1),De.height(e?"100%":n.height,!1),e||f.scrollTop(V),ke(),De)},ke=function(){n.autoExpand&&!L&&setTimeout(De.expandToContent,200)},De.expandToContent=function(e){if(!De.maximize()){if(L=!1,!W){var t=n.resizeMinHeight||n.height||Re.height();W={min:t,max:n.resizeMaxHeight||2*t}}var o=document.createRange();o.selectNodeContents(C[0]);var i=o.getBoundingClientRect(),r=S[0].documentElement.clientHeight,a=i.bottom-i.top,s=De.height()+(a-r);e||-1===W.max||(s=Math.min(s,W.max)),De.height(Math.ceil(Math.max(s,W.min)))}},De.destroy=function(){N&&(N.destroy(),F=null,D=null,N=null,k&&k.off().remove(),p.off("click",ue),f.off("resize orientationChanged",de),o(Me.form).off("reset",ae).off("submit",De.updateOriginal),C.off(),S.off().find("*").remove(),E.off().remove(),x.remove(),y.off().find("*").off().remove(),y.remove(),Re.removeData("sceditor").removeData("sceditorbbcode").show(),I&&Re.attr("required","required"))},De.createDropDown=function(e,t,i,r){var a,s="sceditor-"+t,l=k&&k.is("."+s);De.closeDropDown(!0),l||(!1!==r&&o(i).find(":not(input,textarea)").filter(function(){return 1===this.nodeType}).attr("unselectable","on"),a={top:e.offset().top,left:e.offset().left,marginTop:e.outerHeight()},o.extend(a,n.dropDownCss),k=o('<div class="sceditor-dropdown '+s+'" />').css(a).append(i).appendTo(o("body")).on("click focusin",function(e){e.stopPropagation()}),setTimeout(function(){k&&k.find("input,textarea").first().focus()}))},ue=function(e){3!==e.which&&k&&(Te(),De.closeDropDown())},te=function(e){var t=h||l.edge,n=C[0],o=e.originalEvent.clipboardData;if(o&&!t){var i={},r=o.types,a=o.items;e.preventDefault();for(var s=0;s<r.length;s++){if(window.FileReader&&a&&m.test(a[s].type))return function(e){var t=new FileReader;t.onload=function(e){ne({html:'<img src="'+e.target.result+'" />'})},t.readAsDataURL(e)}(o.items[s].getAsFile());i[r[s]]=o.getData(r[s])}i.text=i["text/plain"],i.html=i["text/html"],ne(i)}else if(!P){var c=n.scrollTop;for(F.saveRange(),P=document.createDocumentFragment();n.firstChild;)P.appendChild(n.firstChild);setTimeout(function(){var e=n.innerHTML;n.innerHTML="",n.appendChild(P),n.scrollTop=c,P=!1,F.restoreRange(),ne({html:e})},0)}},ne=function(e){var t=S[0].createElement("div");N.call("pasteRaw",e),e.html?(t.innerHTML=e.html,a.fixNesting(t)):t.innerHTML=s.entities(e.text||"");var n={val:t.innerHTML};N.hasHandler("toSource")&&(C.append(t),n.val=N.callOnlyFirst("toSource",n.val,o(t)),o(t).remove()),N.call("paste",n),N.hasHandler("toWysiwyg")&&(n.val=N.callOnlyFirst("toWysiwyg",n.val,!0)),N.call("pasteHtml",n),De.wysiwygEditorInsertHtml(n.val,null,!0)},De.closeDropDown=function(e){k&&(k.off().remove(),k=null),!0===e&&De.focus()},De.wysiwygEditorInsertHtml=function(e,t,n){var i,r,s,l=b.height();De.focus(),(n||!o(A).is("code")&&0===o(A).parents("code").length)&&(F.insertHTML(e,t),F.saveRange(),q(C[0]),i=C.find("#sceditor-end-marker").show(),r=C.scrollTop()||S.scrollTop(),s=a.getOffset(i[0]).top+1.5*i.outerHeight(!0)-l,i.hide(),(s>r||s+l<r)&&(C.scrollTop(s),S.scrollTop(s)),Ce(!1),F.restoreRange(),ge())},De.wysiwygEditorInsertText=function(e,t){De.wysiwygEditorInsertHtml(s.entities(e),s.entities(t))},De.insertText=function(e,t){return De.inSourceMode()?De.sourceEditorInsertText(e,t):De.wysiwygEditorInsertText(e,t),De},De.sourceEditorInsertText=function(e,t){var n,o,i,r=T.selectionStart,a=T.selectionEnd;o=T.scrollTop,T.focus(),void 0!==r?(i=T.value,t&&(e+=i.substring(r,a)+t),T.value=i.substring(0,r)+e+i.substring(a,i.length),T.selectionStart=r+e.length-(t?t.length:0),T.selectionEnd=T.selectionStart):(n=d.selection.createRange(),t&&(e+=n.text+t),n.text=e,t&&n.moveEnd("character",0-t.length),n.moveStart("character",n.End-n.Start),n.select()),T.scrollTop=o,T.focus(),Ce()},De.getRangeHelper=function(){return F},De.sourceEditorCaret=function(e){var t={};return T.focus(),e?(T.selectionStart=e.start,T.selectionEnd=e.end):(t.start=T.selectionStart,t.end=T.selectionEnd),e?this:t},De.val=function(e,t){return"string"!=typeof e?De.inSourceMode()?De.getSourceEditorValue(!1):De.getWysiwygEditorValue(t):(De.inSourceMode()?De.setSourceEditorValue(e):(!1!==t&&N.hasHandler("toWysiwyg")&&(e=N.callOnlyFirst("toWysiwyg",e)),De.setWysiwygEditorValue(e)),De)},De.insert=function(e,t,n,i,r){if(De.inSourceMode())return De.sourceEditorInsertText(e,t),De;if(t){var a=F.selectedHtml(),s=o("<div>").appendTo(o("body")).hide().html(a);!1!==n&&N.hasHandler("toSource")&&(a=N.callOnlyFirst("toSource",a,s)),s.remove(),e+=a+t}return!1!==n&&N.hasHandler("toWysiwyg")&&(e=N.callOnlyFirst("toWysiwyg",e,!0)),!1!==n&&!0===r&&(e=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")),De.wysiwygEditorInsertHtml(e),De},De.getWysiwygEditorValue=function(e){var t,n=o("<div>",S[0]).append(o(C[0].childNodes).clone()).appendTo(C);return a.fixNesting(n[0]),t=n.html(),!1!==e&&N.hasHandler("toSource")&&(t=N.callOnlyFirst("toSource",t,n)),n.remove(),t},De.getBody=function(){return C},De.getContentAreaContainer=function(){return b},De.getSourceEditorValue=function(e){var t=E.val();return!1!==e&&N.hasHandler("toWysiwyg")&&(t=N.callOnlyFirst("toWysiwyg",t)),t},De.setWysiwygEditorValue=function(e){e||(e="<p>"+(h?"":"<br />")+"</p>"),C[0].innerHTML=e,q(C[0]),ge(),Ce(),ke()},De.setSourceEditorValue=function(e){E.val(e),Ce()},De.updateOriginal=function(){Re.val(De.val())},q=function(e){if(n.emoticonsEnabled&&!o(e).parents("code").length){var t=e.ownerDocument,i=[],r={},l=o.extend({},n.emoticons.more,n.emoticons.dropdown,n.emoticons.hidden);o.each(l,function(e){n.emoticonsCompat&&(r[e]=new RegExp("(>|^|\\s| | | | |&nbsp;)"+s.regex(e)+"($|<|\\s| | | | |&nbsp;)")),i.push(e)}),i.sort(function(e,t){return e.length-t.length});var u=function(e){for(e=e.firstChild;e;){var s,d,f,p,h,g,m,v=e.parentNode,y=e.nodeValue;if(3!==e.nodeType)o(e).is("code")||u(e);else if(y)for(h=i.length;h--;)d=i[h],(m=n.emoticonsCompat?y.search(r[d]):y.indexOf(d))>-1&&(g=e.nextSibling,f=l[d],s=y.substr(m).split(d),y=y.substr(0,m)+s.shift(),e.nodeValue=y,p=a.parseHTML(c("emoticon",{key:d,url:f.url||f,tooltip:f.tooltip||d}),t),v.insertBefore(p[0],g),v.insertBefore(t.createTextNode(s.join(d)),g));e=e.nextSibling}};u(e),n.emoticonsCompat&&(ze=C.find("img[data-sceditor-emoticon]"))}},De.inSourceMode=function(){return y.hasClass("sourceMode")},De.sourceMode=function(e){var t=De.inSourceMode();return"boolean"!=typeof e?t:((t&&!e||!t&&e)&&De.toggleSourceMode(),De)},De.toggleSourceMode=function(){var e=De.inSourceMode();!l.isWysiwygSupported&&e||(e||(F.saveRange(),F.clear()),De.blur(),e?De.setWysiwygEditorValue(De.getSourceEditorValue()):De.setSourceEditorValue(De.getWysiwygEditorValue()),D=null,E.toggle(),b.toggle(),y.toggleClass("wysiwygMode",e).toggleClass("sourceMode",!e),fe(),pe())},he=function(){return T.focus(),void 0!==T.selectionStart?T.value.substring(T.selectionStart,T.selectionEnd):d.selection.createRange().text},U=function(e,t){De.inSourceMode()?t.txtExec&&(o.isArray(t.txtExec)?De.sourceEditorInsertText.apply(De,t.txtExec):t.txtExec.call(De,e,he())):t.exec&&(o.isFunction(t.exec)?t.exec.call(De,e):De.execCommand(t.exec,t.hasOwnProperty("execParam")?t.execParam:null))},$=function(){h&&(D=F.selectedRange())},De.execCommand=function(e,t){var n=!1,i=De.commands[e],r=o(F.parentNode());if(De.focus(),!r.is("code")&&0===r.parents("code").length){try{n=S[0].execCommand(e,!1,t)}catch(e){}!n&&i&&i.errorMessage&&alert(De._(i.errorMessage)),pe()}},me=function(){function e(){if(F&&!F.compare(O)){if((O=F.cloneSelected())&&O.collapsed){var e=O.startContainer,n=O.startOffset;for(n&&3!==e.nodeType&&(e=e.childNodes[n]);e&&e.parentNode!==C;)e=e.parentNode;e&&a.isInline(e,!0)&&(F.saveRange(),t(C,S),F.restoreRange())}y.trigger(o.Event("selectionchanged"))}_=!1}_||(_=!0,"onselectionchange"in S?e():setTimeout(e,100))},ve=function(){var e,t=F.parentNode();z!==t&&(e=z,z=t,A=F.getFirstBlockParent(t),y.trigger(o.Event("nodechanged",{oldNode:e,newNode:z})))},De.currentNode=function(){return z},De.currentBlockNode=function(){return A},pe=function(e){var t,n,o=S[0],i=De.sourceMode();if(De.readOnly())x.find("active").removeClass("active");else{i||(n=e?e.newNode:F.parentNode(),t=F.getFirstBlockParent(n));for(var r=0;r<Fe.length;r++){var a=0,s=Ae[Fe[r].name],l=Fe[r].state,c=i&&!s.data("sceditor-txtmode")||!i&&!s.data("sceditor-wysiwygmode");if("string"==typeof l){if(!i)try{(a=o.queryCommandEnabled(l)?0:-1)>-1&&(a=o.queryCommandState(l)?1:0)}catch(e){}}else c||(a=l.call(De,n,t));s.toggleClass("disabled",c||a<0).toggleClass("active",a>0)}}},re=function(e){if(!e.originalEvent.defaultPrevented&&(De.closeDropDown(),13===e.which)){var t=o(A);if(t.length&&!t.is("li,ul,ol")){D=null;var n=S[0].createElement("br");if(F.insertNode(n),!g){var i=n.parentNode,r=i.lastChild;r&&3===r.nodeType&&""===r.nodeValue&&(i.removeChild(r),r=i.lastChild),!a.isInline(i,!0)&&r===n&&a.isInline(n.previousSibling)&&F.insertHTML("<br>")}e.preventDefault()}}},ge=function(){var e,t=C[0];a.rTraverse(t,function(n){if(e=n.nodeName.toLowerCase(),1===n.nodeType&&!/inline/.test(a.getStyle(n,"display"))&&o(n).hasClass("sceditor-nlf")&&a.hasStyling(n)){var i=S[0].createElement("p");return i.className="sceditor-nlf",i.innerHTML=g?"":"<br />",t.appendChild(i),!1}if(3===n.nodeType&&!/^\s*$/.test(n.nodeValue)||"br"===e)return!1})},ae=function(){De.val(Re.val())},se=function(){De.closeDropDown(),D=null},de=function(){var e=n.height,t=n.width;De.maximize()?De.dimensions("100%","100%",!1):(e&&e.toString().indexOf("%")>-1||t&&t.toString().indexOf("%")>-1)&&De.dimensions(t,e)},De._=function(){var e=arguments;return H&&H[e[0]]&&(e[0]=H[e[0]]),e[0].replace(/\{(\d+)\}/g,function(t,n){return void 0!==e[n-0+1]?e[n-0+1]:"{"+n+"}"})},ce=function(e){N.call(e.type+"Event",e,De);var t=e.target===T?"scesrc":"scewys",n=o.Event(e);n.type=t+e.type,y.trigger(n,De)},De.bind=function(e,t,n,i){for(var r=(e=e.split(" ")).length;r--;)o.isFunction(t)&&(n||y.on("scewys"+e[r],t),i||y.on("scesrc"+e[r],t),"valuechanged"===e[r]&&(Ce.hasHandler=!0));return De},De.unbind=function(e,t,n,i){for(var r=(e=e.split(" ")).length;r--;)o.isFunction(t)&&(n||y.off("scewys"+e[r],t),i||y.off("scesrc"+e[r],t));return De},De.blur=function(e,t,n){return o.isFunction(e)?De.bind("blur",e,t,n):De.sourceMode()?E.blur():C.blur(),De},De.focus=function(e,t,n){if(o.isFunction(e))De.bind("focus",e,t,n);else if(De.inSourceMode())T.focus();else{if(F.hasSelection())return;var i,r=F.selectedRange();O||ye(),!g&&r&&1===r.endOffset&&r.collapsed&&(i=r.endContainer)&&1===i.childNodes.length&&o(i.firstChild).is("br")&&(r.setStartBefore(i.firstChild),r.collapse(!0),F.selectRange(r)),w.contentWindow.focus(),C[0].focus(),D&&(F.selectRange(D),D=null)}return pe(),De},De.keyDown=function(e,t,n){return De.bind("keydown",e,t,n)},De.keyPress=function(e,t,n){return De.bind("keypress",e,t,n)},De.keyUp=function(e,t,n){return De.bind("keyup",e,t,n)},De.nodeChanged=function(e){return De.bind("nodechanged",e,!1,!0)},De.selectionChanged=function(e){return De.bind("selectionchanged",e,!1,!0)},De.valueChanged=function(e,t,n){return De.bind("valuechanged",e,t,n)},xe=function(e){var t,i=0,r=De.emoticonsCache,a=String.fromCharCode(e.which);if(!o(A).is("code")&&!o(A).parents("code").length)return r||(r=[],o.each(o.extend({},n.emoticons.more,n.emoticons.dropdown,n.emoticons.hidden),function(e,t){r[i++]=[e,c("emoticon",{key:e,url:t.url||t,tooltip:t.tooltip||e})]}),r.sort(function(e,t){return e[0].length-t[0].length}),De.emoticonsCache=r,De.longestEmoticonCode=r[r.length-1][0].length),t=F.replaceKeyword(De.emoticonsCache,!0,!0,De.longestEmoticonCode,n.emoticonsCompat,a),t&&n.emoticonsCompat?(ze=C.find("img[data-sceditor-emoticon]"),/^\s$/.test(a)):!t},be=function(){if(ze.length){var e,t,n,i,r,a,s=De.currentBlockNode(),l=!1,c=/[^\s\xA0\u2002\u2003\u2009\u00a0]+/;ze=o.map(ze,function(u){return u&&u.parentNode?o.contains(s,u)?(e=u.previousSibling,t=u.nextSibling,null===(r=e.nodeValue)&&(r=e.innerText||""),e&&c.test(e.nodeValue.slice(-1))||t&&c.test((t.nodeValue||"")[0])?(n=u.parentNode,i=F.cloneSelected(),a=i.startContainer,r+=o(u).data("sceditor-emoticon"),a===t?l=r.length+i.startOffset:a===s&&s.childNodes[i.startOffset]===t?l=r.length:a===e&&(l=i.startOffset),t&&3===t.nodeType||(t=n.insertBefore(n.ownerDocument.createTextNode(""),t)),t.insertData(0,r),n.removeChild(e),n.removeChild(u),!1!==l&&(i.setStart(t,l),i.collapse(!0),F.selectRange(i)),null):u):u:null})}},De.emoticons=function(e){return e||!1===e?(n.emoticonsEnabled=e,e?(C.keypress(xe),De.sourceMode()||(F.saveRange(),q(C[0]),ze=C.find("img[data-sceditor-emoticon]"),Ce(!1),F.restoreRange())):(C.find("img[data-sceditor-emoticon]").replaceWith(function(){return o(this).data("sceditor-emoticon")}),ze=[],C.off("keypress",xe),Ce()),De):n.emoticonsEnabled},De.css=function(e){return B||(B=o('<style id="#inline" />',S[0]).appendTo(S.find("head"))[0]),"string"!=typeof e?B.styleSheet?B.styleSheet.cssText:B.innerHTML:(B.styleSheet?B.styleSheet.cssText=e:B.innerHTML=e,De)},oe=function(e){var t=[],n={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|","[":"{","]":"}"},o={8:"backspace",9:"tab",13:"enter",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",91:"win",92:"win",93:"select",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},i={109:"-",110:"del",111:"/",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"},r=e.which,a=o[r]||String.fromCharCode(r).toLowerCase();if((e.ctrlKey||e.metaKey)&&t.push("ctrl"),e.altKey&&t.push("alt"),e.shiftKey&&(t.push("shift"),i[r]?a=i[r]:n[a]&&(a=n[a])),a&&(r<16||r>18)&&t.push(a),t=t.join("+"),Ne[t])return Ne[t].call(De)},De.addShortcut=function(e,t){return e=e.toLowerCase(),Ne[e]="string"==typeof t?function(){return U(Ae[t],De.commands[t]),!1}:t,De},De.removeShortcut=function(e){return delete Ne[e.toLowerCase()],De},ie=function(e){var t,i,r,a,s;if(!n.disableBlockRemove&&8===e.which&&(a=F.selectedRange())&&(u.getSelection?(t=a.startContainer,i=a.startOffset):(t=a.parentElement(),(r=S[0].selection.createRange()).moveToElementText(t),r.setEndPoint("EndToStart",a),i=r.text.length),0===i&&(s=we()))){for(;t!==s;){for(;t.previousSibling;)if(3!==(t=t.previousSibling).nodeType||t.nodeValue)return;if(!(t=t.parentNode))return}if(s&&!o(s).is("body"))return De.clearBlockFormatting(s),!1}},we=function(){for(var e=A;!a.hasStyling(e)||a.isInline(e,!0);)if(!(e=e.parentNode)||o(e).is("body"))return;return e},De.clearBlockFormatting=function(e){return!(e=e||we())||o(e).is("body")?De:(F.saveRange(),e.className="",D=null,o(e).attr("style",""),o(e).is("p,div,td")||a.convertElement(e,"p"),F.restoreRange(),De)},Ce=function(e){if(N&&(N.hasHandler("valuechangedEvent")||Ce.hasHandler)){var t,n=De.sourceMode(),i=!n&&F.hasSelection();M=!1,e=!1!==e&&!S[0].getElementById("sceditor-start-marker"),R&&(clearTimeout(R),R=!1),i&&e&&F.saveRange(),(t=n?E.val():C.html())!==Ce.lastVal&&(Ce.lastVal=t,y.trigger(o.Event("valuechanged",{rawValue:n?De.val():t}))),i&&e&&F.removeMarkers()}},Se=function(){R&&Ce()},Ee=function(e){var t=e.which,n=Ee.lastChar,o=13===n||32===n,i=8===n||46===n;Ee.lastChar=t,M||(13===t||32===t?o?Ee.triggerNext=!0:Ce():8===t||46===t?i?Ee.triggerNext=!0:Ce():Ee.triggerNext&&(Ce(),Ee.triggerNext=!1),R&&clearTimeout(R),R=setTimeout(function(){M||Ce()},1500))},le=function(e){(M=/start/i.test(e.type))||Ce()},Te=function(){De.updateOriginal()},j()};return v.locale={},v.command={get:function(e){return v.commands[e]||null},set:function(e,t){return!(!e||!t)&&(t=o.extend(v.commands[e]||{},t),t.remove=function(){v.command.remove(e)},v.commands[e]=t,this)},remove:function(e){return v.commands[e]&&delete v.commands[e],this}},v}.call(t,n,t,e))&&(e.exports=o)},function(e,t,n){var o;void 0!==(o=function(){"use strict";var e={},t=function(t){var n=this,o=[],i=function(e){return"signal"+e.charAt(0).toUpperCase()+e.slice(1)},r=function(e,n){e=[].slice.call(e);var r,a,s=i(e.shift());for(r=0;r<o.length;r++)if(s in o[r]&&(a=o[r][s].apply(t,e),n))return a};n.call=function(){r(arguments,!1)},n.callOnlyFirst=function(){return r(arguments,!0)},n.hasHandler=function(e){var t=o.length;for(e=i(e);t--;)if(e in o[t])return!0;return!1},n.exists=function(t){return t in e&&"function"==typeof(t=e[t])&&"object"==typeof t.prototype},n.isRegistered=function(t){if(n.exists(t))for(var i=o.length;i--;)if(o[i]instanceof e[t])return!0;return!1},n.register=function(i){return!(!n.exists(i)||n.isRegistered(i)||(i=new e[i],o.push(i),"init"in i&&i.init.call(t),0))},n.deregister=function(i){var r,a=o.length,s=!1;if(!n.isRegistered(i))return s;for(;a--;)o[a]instanceof e[i]&&(s=!0,"destroy"in(r=o.splice(a,1)[0])&&r.destroy.call(t));return s},n.destroy=function(){for(var e=o.length;e--;)"destroy"in o[e]&&o[e].destroy.call(t);o=[],t=null}};return t.plugins=e,t}.call(t,n,t,e))&&(e.exports=o)},function(e,t,n){var o;void 0!==(o=function(e){"use strict";var t=n(1),o=n(5),i=n(6),r=n(7).ie,a=r&&r<11,s=function(e,t,n){var o,i,r,a,s,l="",c=e.startContainer,u=e.startOffset;for(c&&3!==c.nodeType&&(c=c.childNodes[u],u=0),r=a=u;n>l.length&&c&&3===c.nodeType;)o=c.nodeValue,i=n-l.length,s&&(a=o.length,r=0),s=c,t?(u=r=Math.max(a-i,0),l=o.substr(r,a-r)+l,c=s.previousSibling):(u=r+(a=Math.min(i,o.length)),l+=o.substr(r,a),c=s.nextSibling);return{node:s||c,offset:u,text:l}};return function(e,n){var r,l,c=n||e.contentDocument||e.document,u="sceditor-start-marker",d="sceditor-end-marker",f=this;f.insertHTML=function(e,t){var n,o;if(!f.selectedRange())return!1;for(t&&(e+=f.selectedHtml()+t),o=c.createElement("p"),n=c.createDocumentFragment(),o.innerHTML=e;o.firstChild;)n.appendChild(o.firstChild);f.insertNode(n)},l=function(e,n,i){var a,s,l=c.createElement("div"),p=t(l);if("string"==typeof e?(n&&(e+=f.selectedHtml()+n),p.html(e)):(p.append(e),n&&p.append(f.selectedRange().extractContents()).append(n)),a=l.lastChild){for(;!o.isInline(a.lastChild,!0);)a=a.lastChild;return o.canHaveChildren(a)&&(s=t(a),a.lastChild||s.append("​")),f.removeMarkers(),(s||p).append(r(u)).append(r(d)),i?p.html():t(c.createDocumentFragment()).append(p.contents())[0]}},f.insertNode=function(e,t){var n=l(e,t),i=f.selectedRange(),r=i.commonAncestorContainer;if(!n)return!1;i.deleteContents(),r&&3!==r.nodeType&&!o.canHaveChildren(r)?r.parentNode.insertBefore(n,r):i.insertNode(n),f.restoreRange()},f.cloneSelected=function(){var e=f.selectedRange();if(e)return e.cloneRange()},f.selectedRange=function(){var t,n,o=e.getSelection();if(o){if(o.getRangeAt&&o.rangeCount<=0){for(n=c.body;n.firstChild;)n=n.firstChild;(t=c.createRange()).setStartBefore(n),o.addRange(t)}return o.rangeCount>0&&(t=o.getRangeAt(0)),t}},f.hasSelection=function(){var t=e.getSelection();return t&&t.rangeCount>0},f.selectedHtml=function(){var e,t=f.selectedRange();return t?((e=c.createElement("p")).appendChild(t.cloneContents()),e.innerHTML):""},f.parentNode=function(){var e=f.selectedRange();if(e)return e.parentElement?e.parentElement():e.commonAncestorContainer},f.getFirstBlockParent=function(e){var t=function(e){return o.isInline(e,!0)?(e=e?e.parentNode:null,e?t(e):e):e};return t(e||f.parentNode())},f.insertNodeAt=function(e,t){var n=f.selectedRange(),o=f.cloneSelected();if(!o)return!1;o.collapse(e),o.insertNode(t),f.selectRange(n)},r=function(e){f.removeMarker(e);var t=c.createElement("span");return t.id=e,t.style.lineHeight="0",t.style.display="none",t.className="sceditor-selection sceditor-ignore",t.innerHTML=" ",t},f.insertMarkers=function(){var e=f.selectedRange();f.insertNodeAt(!0,r(u)),e&&e.collapsed?t(f.getMarker(u)).after(r(d)):f.insertNodeAt(!1,r(d))},f.getMarker=function(e){return c.getElementById(e)},f.removeMarker=function(e){var t=f.getMarker(e);t&&t.parentNode.removeChild(t)},f.removeMarkers=function(){f.removeMarker(u),f.removeMarker(d)},f.saveRange=function(){f.insertMarkers()},f.selectRange=function(n){var i,r=e.getSelection(),s=n.endContainer;if(!a&&n.collapsed&&s&&!o.isInline(s,!0)){for(i=s.lastChild;i&&t(i).is(".sceditor-ignore");)i=i.previousSibling;if(t(i).is("br")){var l=c.createRange();l.setEndAfter(i),l.collapse(!1),f.compare(n,l)&&(n.setStartBefore(i),n.collapse(!0))}}r&&(f.clear(),r.addRange(n))},f.restoreRange=function(){var e,t=f.selectedRange(),n=f.getMarker(u),o=f.getMarker(d);if(!n||!o||!t)return!1;e=n.nextSibling===o,(t=c.createRange()).setStartBefore(n),t.setEndAfter(o),e&&t.collapse(!0),f.selectRange(t),f.removeMarkers()},f.selectOuterText=function(e,t){var n,o,i=f.cloneSelected();if(!i)return!1;i.collapse(!1),n=s(i,!0,e),o=s(i,!1,t),i.setStart(n.node,n.offset),i.setEnd(o.node,o.offset),f.selectRange(i)},f.getOuterText=function(e,t){var n=f.cloneSelected();return n?(n.collapse(!e),s(n,e,t).text):""},f.replaceKeyword=function(e,t,n,o,r,a){n||e.sort(function(e,t){return e[0].length-t[0].length});var s,l,c,u,d,p,h,g,m=e.length,v=r?1:0,y=o||e[m-1][0].length;for(r&&y++,a=a||"",d=(s=f.getOuterText(!0,y)).length,s+=a,t&&(s+=f.getOuterText(!1,y));m--;)if(h=e[m][0],g=h.length,u=Math.max(0,d-g-v),c=-1,r?(l=s.substr(u).match(new RegExp("(^|[\\s    ])"+i.regex(h)+"(^|[\\s    ])")))&&(c=l.index+u+l[1].length):c=s.indexOf(h,u),c>-1&&c<=d&&c+g+v>=d)return p=d-c,f.selectOuterText(p,g-p-(/^\S/.test(a)?1:0)),f.insertHTML(e[m][1]),!0;return!1},f.compare=function(e,t){return t||(t=f.selectedRange()),e&&t?0===e.compareBoundaryPoints(Range.END_TO_END,t)&&0===e.compareBoundaryPoints(Range.START_TO_START,t):!e&&!t},f.clear=function(){var t=e.getSelection();t&&(t.removeAllRanges?t.removeAllRanges():t.empty&&t.empty())}}}.call(t,n,t,e))&&(e.exports=o)},function(e,t,n){var o;void 0!==(o=function(e){"use strict";var t=n(1),o={},i={traverse:function(e,t,n,o,r){if(e)for(e=r?e.lastChild:e.firstChild;e;){var a=r?e.previousSibling:e.nextSibling;if(!n&&!1===t(e)||!o&&!1===i.traverse(e,t,n,o,r)||n&&!1===t(e))return!1;e=a}},rTraverse:function(e,t,n,o){this.traverse(e,t,n,o,!0)},parseHTML:function(e,n){var o=[],i=(n||document).createElement("div");return i.innerHTML=e,t.merge(o,i.childNodes),o},hasStyling:function(e){var n=t(e);return e&&(!n.is("p,div")||e.className||n.attr("style")||!t.isEmptyObject(n.data()))},convertElement:function(e,t){for(var n,o,i=e.attributes,r=i.length,a=e.ownerDocument.createElement(t);r--;){o=i[r];try{a.setAttribute(o.name,o.value)}catch(e){}}for(;n=e.firstChild;)a.appendChild(n);return e.parentNode.replaceChild(a,e),a},blockLevelList:"|body|hr|p|div|h1|h2|h3|h4|h5|h6|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|blockquote|center|",canHaveChildren:function(e){return!!/11?|9/.test(e.nodeType)&&"|iframe|area|base|basefont|br|col|frame|hr|img|input|wbr|isindex|link|meta|param|command|embed|keygen|source|track|object|".indexOf("|"+e.nodeName.toLowerCase()+"|")<0},isInline:function(e,t){var n,o=(e||{}).nodeType||3;return 1!==o?3===o:(n=e.tagName.toLowerCase(),"code"===n?!t:i.blockLevelList.indexOf("|"+n+"|")<0)},copyCSS:function(e,t){t.style.cssText=e.style.cssText+t.style.cssText},fixNesting:function(e){var n=function(e){for(;i.isInline(e.parentNode,!0);)e=e.parentNode;return e};i.traverse(e,function(e){var o=!i.isInline(e,!0),r=t(e);if(o&&i.isInline(e.parentNode,!0)){var a=n(e),s=a.parentNode,l=i.extractContents(a,e),c=e;i.copyCSS(a,c),s.insertBefore(l,a),s.insertBefore(c,a)}if(o&&r.is("ul,ol")&&r.parent().is("ul,ol")){var u=r.prev("li");u.length?u.append(r):r.wrap("<li />")}})},findCommonAncestor:function(e,n){return t(e).parents().has(t(n)).first()},getSibling:function(e,t){return e?(t?e.previousSibling:e.nextSibling)||i.getSibling(e.parentNode,t):null},removeWhiteSpace:function(e,n){for(var o,r,a,s,l,c,u,d,f=i.getSibling,p=i.isInline,h=e.firstChild;h;){if(u=h.nextSibling,o=h.nodeValue,1===(r=h.nodeType)&&h.firstChild&&(c=t(h).css("whiteSpace"),/pre(\-wrap)?$/i.test(c)||i.removeWhiteSpace(h,/line$/i.test(c))),3===r){for(a=f(h),s=f(h,!0),d=!1;t(s).hasClass("sceditor-ignore");)s=f(s,!0);if(p(h)&&s){for(l=s;l.lastChild;)l=l.lastChild;d=3===l.nodeType?/[\t\n\r ]$/.test(l.nodeValue):!p(l)}o=o.replace(/\u200B/g,""),s&&p(s)&&!d||(o=o.replace(n?/^[\t ]+/:/^[\t\n\r ]+/,"")),a&&p(a)||(o=o.replace(n?/[\t ]+$/:/[\t\n\r ]+$/,"")),o.length?h.nodeValue=o.replace(n?/[\t ]+/g:/[\t\n\r ]+/g," "):e.removeChild(h)}h=u}},extractContents:function(e,n){var o,r=i.findCommonAncestor(e,n).get(0),a=!1,s=!1;return(o=function(r){var l,c=e.ownerDocument.createDocumentFragment();return i.traverse(r,function(i){if(s||i===n)return s=!0,!1;i===e&&(a=!0),t.contains(i,e)||a&&t.contains(i,n)?((l=i.cloneNode(!1)).appendChild(o(i)),c.appendChild(l)):a&&!t.contains(c,i)&&c.appendChild(i)},!1),c})(r)},getOffset:function(e){for(var t=0,n=0;e;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{left:t,top:n}},getStyle:function(e,n){var i,r,a,s=e.style;if(!s)return"";if(o[n]||(o[n]=t.camelCase(n)),n=o[n],a=s[n],"textAlign"===n){if(i=t(e),r=s.direction,a=a||i.css(n),i.parent().css(n)===a||"block"!==i.css("display")||i.is("hr")||i.is("th"))return"";if(/right/i.test(a)&&"rtl"===r||/left/i.test(a)&&"ltr"===r)return""}return a},hasStyle:function(e,n,o){var r=i.getStyle(e,n);return!!r&&(!o||r===o||t.isArray(o)&&t.inArray(r,o)>-1)}};return i}.call(t,n,t,e))&&(e.exports=o)},function(e,t,n){var o;void 0!==(o=function(e,t){"use strict";var n=/^(https?|s?ftp|mailto|spotify|skype|ssh|teamspeak|tel):|(\/\/)|data:image\/(png|bmp|gif|p?jpe?g);/i;t.regex=function(e){return e.replace(/([\-.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},t.entities=function(e,t){if(!e)return e;var n={"&":"&amp;","<":"&lt;",">":"&gt;","  ":"&nbsp; ","\r\n":"<br />","\r":"<br />","\n":"<br />"};return!1!==t&&(n['"']="&#34;",n["'"]="&#39;",n["`"]="&#96;"),e=e.replace(/ {2}|\r\n|[&<>\r\n'"`]/g,function(e){return n[e]||e})},t.uriScheme=function(e){var t,o=/^[^\/]*:/i,i=window.location;return e&&o.test(e)&&!n.test(e)?((t=i.pathname.split("/")).pop(),i.protocol+"//"+i.host+t.join("/")+"/"+e):e}}.call(t,n,t,e))&&(e.exports=o)},function(e,t,n){var o;void 0!==(o=function(e,t){"use strict";var o=n(1),i=navigator.userAgent;t.ie=function(){var e=3,t=document,n=t.createElement("div"),o=n.getElementsByTagName("i");do{n.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e"}while(o[0]);return t.documentMode&&t.all&&window.atob&&(e=10),4===e&&t.documentMode&&(e=11),e>4?e:void 0}(),t.edge="-ms-ime-align"in document.documentElement.style,t.ios=/iPhone|iPod|iPad| wosbrowser\//i.test(i),t.isWysiwygSupported=function(){var e,n,r=o('<p contenteditable="true">')[0].contentEditable;return void 0!==r&&"inherit"!==r&&(n=/Opera Mobi|Opera Mini/i.test(i),/Android/i.test(i)&&(n=!0,/Safari/.test(i)&&(n=!(e=/Safari\/(\d+)/.exec(i))||!e[1]||e[1]<534)),/ Silk\//i.test(i)&&(n=!(e=/AppleWebKit\/(\d+)/.exec(i))||!e[1]||e[1]<534),t.ios&&(n=/OS [0-4](_\d)+ like Mac/i.test(i)),/Firefox/i.test(i)&&(n=!1),/OneBrowser/i.test(i)&&(n=!1),"UCWEB"===navigator.vendor&&(n=!1),t.ie<9&&(n=!0),!n)}()}.call(t,n,t,e))&&(e.exports=o)},function(e,t,n){var o;void 0!==(o=function(e){"use strict";var t=n(1),o={html:'<!DOCTYPE html><html{attrs}><head><style>.ie * {min-height: auto !important} .ie table td {height:15px} @supports (-ms-ime-align:auto) { * { min-height: auto !important; } }</style><meta http-equiv="Content-Type" content="text/html;charset={charset}" /><link rel="stylesheet" type="text/css" href="{style}" /></head><body contenteditable="true" {spellcheck}><p></p></body></html>',toolbarButton:'<a class="sceditor-button sceditor-button-{name}" data-sceditor-command="{name}" unselectable="on"><div unselectable="on">{dispName}</div></a>',emoticon:'<img src="{url}" data-sceditor-emoticon="{key}" alt="{key}" title="{tooltip}" />',fontOpt:'<a class="sceditor-font-option" href="#" data-font="{font}"><font face="{font}">{font}</font></a>',sizeOpt:'<a class="sceditor-fontsize-option" data-size="{size}" href="#"><font size="{size}">{size}</font></a>',pastetext:'<div><label for="txt">{label}</label> <textarea cols="20" rows="7" id="txt"></textarea></div><div><input type="button" class="button" value="{insert}" /></div>',table:'<div><label for="rows">{rows}</label><input type="text" id="rows" value="2" /></div><div><label for="cols">{cols}</label><input type="text" id="cols" value="2" /></div><div><input type="button" class="button" value="{insert}" /></div>',image:'<div><label for="link">{url}</label> <input type="text" id="image" placeholder="https://" /></div><div><label for="width">{width}</label> <input type="text" id="width" size="2" /></div><div><label for="height">{height}</label> <input type="text" id="height" size="2" /></div><div><input type="button" class="button" value="{insert}" /></div>',email:'<div><label for="email">{label}</label> <input type="text" id="email" /></div><div><label for="des">{desc}</label> <input type="text" id="des" /></div><div><input type="button" class="button" value="{insert}" /></div>',link:'<div><label for="link">{url}</label> <input type="text" id="link" placeholder="https://" /></div><div><label for="des">{desc}</label> <input type="text" id="des" /></div><div><input type="button" class="button" value="{ins}" /></div>',youtubeMenu:'<div><label for="link">{label}</label> <input type="text" id="link" placeholder="https://" /></div><div><input type="button" class="button" value="{insert}" /></div>',youtube:'<iframe width="560" height="315" frameborder="0" allowfullscreensrc="https://www.youtube.com/embed/{id}?wmode=opaque&start={time}" data-youtube-id="{id}"></iframe>'};return function(e,n,i){var r=o[e];return t.each(n,function(e,t){r=r.replace(new RegExp("\\{"+e+"\\}","g"),t)}),i&&(r=t(r)),r}}.call(t,n,t,e))&&(e.exports=o)},function(e,t,n){var o;void 0!==(o=function(e){"use strict";function t(e){if("mozHidden"in document)for(var t,n=e.getBody()[0];n;){if((t=n).firstChild)t=t.firstChild;else{for(;t&&!t.nextSibling;)t=t.parentNode;t&&(t=t.nextSibling)}3===n.nodeType&&/[\n\r\t]+/.test(n.nodeValue)&&(/^pre/.test(o(n.parentNode).css("white-space"))||o(n).remove()),n=t}}var o=n(1),i=n(7).ie,r=n(8),a=i&&i<11,s={bold:{exec:"bold",tooltip:"Bold",shortcut:"Ctrl+B"},italic:{exec:"italic",tooltip:"Italic",shortcut:"Ctrl+I"},underline:{exec:"underline",tooltip:"Underline",shortcut:"Ctrl+U"},strike:{exec:"strikethrough",tooltip:"Strikethrough"},subscript:{exec:"subscript",tooltip:"Subscript"},superscript:{exec:"superscript",tooltip:"Superscript"},left:{exec:"justifyleft",tooltip:"Align left"},center:{exec:"justifycenter",tooltip:"Center"},right:{exec:"justifyright",tooltip:"Align right"},justify:{exec:"justifyfull",tooltip:"Justify"},font:{_dropDown:function(e,t,n){for(var i=0,a=e.opts.fonts.split(","),s=o("<div />"),l=function(){return n(o(this).data("font")),e.closeDropDown(!0),!1};i<a.length;i++)s.append(r("fontOpt",{font:a[i]},!0).click(l));e.createDropDown(t,"font-picker",s)},exec:function(e){var t=this;s.font._dropDown(t,e,function(e){t.execCommand("fontname",e)})},tooltip:"Font Name"},size:{_dropDown:function(e,t,n){for(var i=o("<div />"),a=function(t){n(o(this).data("size")),e.closeDropDown(!0),t.preventDefault()},s=1;s<=7;s++)i.append(r("sizeOpt",{size:s},!0).click(a));e.createDropDown(t,"fontsize-picker",i)},exec:function(e){var t=this;s.size._dropDown(t,e,function(e){t.execCommand("fontsize",e)})},tooltip:"Font Size"},color:{_dropDown:function(e,t,n){var i=o("<div />"),r="",a=s.color;a._htmlCache||(e.opts.colors.split("|").forEach(function(e){r+='<div class="sceditor-color-column">',e.split(",").forEach(function(e){r+='<a href="#" class="sceditor-color-option" style="background-color: '+e+'" data-color="'+e+'"></a>'}),r+="</div>"}),a._htmlCache=r),i.html(a._htmlCache).find("a").click(function(t){n(o(this).attr("data-color")),e.closeDropDown(!0),t.preventDefault()}),e.createDropDown(t,"color-picker",i)},exec:function(e){var t=this;s.color._dropDown(t,e,function(e){t.execCommand("forecolor",e)})},tooltip:"Font Color"},removeformat:{exec:"removeformat",tooltip:"Remove Formatting"},cut:{exec:"cut",tooltip:"Cut",errorMessage:"Your browser does not allow the cut command. Please use the keyboard shortcut Ctrl/Cmd-X"},copy:{exec:"copy",tooltip:"Copy",errorMessage:"Your browser does not allow the copy command. Please use the keyboard shortcut Ctrl/Cmd-C"},paste:{exec:"paste",tooltip:"Paste",errorMessage:"Your browser does not allow the paste command. Please use the keyboard shortcut Ctrl/Cmd-V"},pastetext:{exec:function(e){var t,n,o=this;(n=r("pastetext",{label:o._("Paste your text inside the following box:"),insert:o._("Insert")},!0)).find(".button").click(function(e){(t=n.find("#txt").val())&&o.wysiwygEditorInsertText(t),o.closeDropDown(!0),e.preventDefault()}),o.createDropDown(e,"pastetext",n)},tooltip:"Paste Text"},bulletlist:{exec:function(){t(this),this.execCommand("insertunorderedlist")},tooltip:"Bullet list"},orderedlist:{exec:function(){t(this),this.execCommand("insertorderedlist")},tooltip:"Numbered list"},indent:{state:function(e,t){var n,i,r,a=o(t),s=a.parents("ul,ol,menu"),l=s.first();if(s.length>1||l.children().length>1)return 0;if(a.is("ul,ol,menu")){if(n=this.getRangeHelper().selectedRange(),!(window.Range&&n instanceof Range))return a.is("li,ul,ol,menu")?0:-1;if(i=n.startContainer.parentNode,r=n.endContainer.parentNode,i!==i.parentNode.firstElementChild||o(r).is("li")&&r!==r.parentNode.lastElementChild)return 0}return-1},exec:function(){var e=this,t=o(e.getRangeHelper().getFirstBlockParent());e.focus(),t.parents("ul,ol,menu")&&e.execCommand("indent")},tooltip:"Add indent"},outdent:{state:function(e,t){return o(t).is("ul,ol,menu")||o(t).parents("ul,ol,menu").length>0?0:-1},exec:function(){var e=this;o(e.getRangeHelper().getFirstBlockParent()).parents("ul,ol,menu")&&e.execCommand("outdent")},tooltip:"Remove one indent"},table:{exec:function(e){var t=this,n=r("table",{rows:t._("Rows:"),cols:t._("Cols:"),insert:t._("Insert")},!0);n.find(".button").click(function(e){var o,i,r=n.find("#rows").val()-0,s=n.find("#cols").val()-0,l="<table>";if(!(r<1||s<1)){for(o=0;o<r;o++){for(l+="<tr>",i=0;i<s;i++)l+="<td>"+(a?"":"<br />")+"</td>";l+="</tr>"}l+="</table>",t.wysiwygEditorInsertHtml(l),t.closeDropDown(!0),e.preventDefault()}}),t.createDropDown(e,"inserttable",n)},tooltip:"Insert a table"},horizontalrule:{exec:"inserthorizontalrule",tooltip:"Insert a horizontal rule"},code:{exec:function(){this.wysiwygEditorInsertHtml("<code>",(a?"":"<br />")+"</code>")},tooltip:"Code"},image:{_dropDown:function(e,t,n){var o=r("image",{url:e._("URL:"),width:e._("Width (optional):"),height:e._("Height (optional):"),insert:e._("Insert")},!0),i=o.find("#image");o.find(".button").click(function(t){i.val()&&n(i.val(),o.find("#width").val(),o.find("#height").val()),e.closeDropDown(!0),t.preventDefault()}),e.createDropDown(t,"insertimage",o)},exec:function(e){var t=this;s.image._dropDown(t,e,function(e,n,o){var i="";n&&(i+=' width="'+n+'"'),o&&(i+=' height="'+o+'"'),t.wysiwygEditorInsertHtml("<img"+i+' src="'+e+'" />')})},tooltip:"Insert an image"},email:{_dropDown:function(e,t,n){function o(t){a.val()&&n(a.val(),i.find("#des").val()),e.closeDropDown(!0),t.preventDefault()}var i=r("email",{label:e._("E-mail:"),desc:e._("Description (optional):"),insert:e._("Insert")},!0),a=i.find("#email");i.find(".button").click(o),a.add(i.find("#des")).keypress(function(e){13===e.which&&a.val()&&o(e)}),e.createDropDown(t,"insertemail",i)},exec:function(e){var t=this;s.email._dropDown(t,e,function(e,n){t.focus(),!t.getRangeHelper().selectedHtml()||n?t.wysiwygEditorInsertHtml('<a href="mailto:'+e+'">'+(n||e)+"</a>"):t.execCommand("createlink","mailto:"+e)})},tooltip:"Insert an email"},link:{_dropDown:function(e,t,n){function o(t){a.val()&&n(a.val(),i.find("#des").val()),e.closeDropDown(!0),t.preventDefault()}var i=r("link",{url:e._("URL:"),desc:e._("Description (optional):"),ins:e._("Insert")},!0),a=i.find("#link");i.find(".button").click(o),a.add(i.find("#des")).keypress(function(e){13===e.which&&a.val()&&o(e)}),e.createDropDown(t,"insertlink",i)},exec:function(e){var t=this;s.link._dropDown(t,e,function(e,n){t.focus(),!t.getRangeHelper().selectedHtml()||n?(n=n||e,t.wysiwygEditorInsertHtml('<a href="'+e+'">'+n+"</a>")):t.execCommand("createlink",e)})},tooltip:"Insert a link"},unlink:{state:function(){var e=o(this.currentNode());return e.is("a")||e.parents("a").length>0?0:-1},exec:function(){var e=o(this.currentNode()),t=e.is("a")?e:e.parents("a").first();t.length&&t.replaceWith(t.contents())},tooltip:"Unlink"},quote:{exec:function(e,t,n){var o="<blockquote>",i="</blockquote>";t?(o=o+(n=n?"<cite>"+n+"</cite>":"")+t+i,i=null):""===this.getRangeHelper().selectedHtml()&&(i=(a?"":"<br />")+i),this.wysiwygEditorInsertHtml(o,i)},tooltip:"Insert a Quote"},emoticon:{exec:function(e){var t=this,n=function(i){var r,a=t.opts.emoticonsCompat,s=t.getRangeHelper(),l=a&&" "!==s.getOuterText(!0,1)?" ":"",c=a&&" "!==s.getOuterText(!1,1)?" ":"",u=o("<div />"),d=o("<div />").appendTo(u),f=0,p=o.extend({},t.opts.emoticons.dropdown,i?t.opts.emoticons.more:{});return o.each(p,function(){f++}),f=Math.sqrt(f),o.each(p,function(e,n){d.append(o("<img />").attr({src:n.url||n,alt:e,title:n.tooltip||e}).click(function(){return t.insert(l+o(this).attr("alt")+c,null,!1).closeDropDown(!0),!1})),d.children().length>=f&&(d=o("<div />").appendTo(u))}),!i&&t.opts.emoticons.more&&(r=o('<a class="sceditor-more">'+t._("More")+"</a>").click(function(){return t.createDropDown(e,"more-emoticons",n(!0)),!1}),u.append(r)),u};t.createDropDown(e,"emoticons",n(!1))},txtExec:function(e){s.emoticon.exec.call(this,e)},tooltip:"Insert an emoticon"},youtube:{_dropDown:function(e,t,n){var i=r("youtubeMenu",{label:e._("Video URL:"),insert:e._("Insert")},!0);i.find(".button").click(function(t){var r=i.find(i,"#link").val(),a=r.match(/(?:v=|v\/|embed\/|youtu.be\/)(.{11})/),s=r.match(/[&|?](?:star)?t=((\d+[hms]?){1,3})/),l=0;s&&o.each(s[1].split(/[hms]/),function(e,t){""!==t&&(l=60*l+Number(t))}),a&&/^[a-zA-Z0-9_\-]{11}$/.test(a[1])&&n(a[1],l),e.closeDropDown(!0),t.preventDefault()}),e.createDropDown(t,"insertlink",i)},exec:function(e){var t=this;s.youtube._dropDown(t,e,function(e){t.wysiwygEditorInsertHtml(r("youtube",{id:e}))})},tooltip:"Insert a YouTube video"},date:{_date:function(e){var t=new Date,n=t.getYear(),o=t.getMonth()+1,i=t.getDate();return n<2e3&&(n=1900+n),o<10&&(o="0"+o),i<10&&(i="0"+i),e.opts.dateFormat.replace(/year/i,n).replace(/month/i,o).replace(/day/i,i)},exec:function(){this.insertText(s.date._date(this))},txtExec:function(){this.insertText(s.date._date(this))},tooltip:"Insert current date"},time:{_time:function(){var e=new Date,t=e.getHours(),n=e.getMinutes(),o=e.getSeconds();return t<10&&(t="0"+t),n<10&&(n="0"+n),o<10&&(o="0"+o),t+":"+n+":"+o},exec:function(){this.insertText(s.time._time())},txtExec:function(){this.insertText(s.time._time())},tooltip:"Insert current time"},ltr:{state:function(e,t){return t&&"ltr"===t.style.direction},exec:function(){var e=this,t=e.getRangeHelper().getFirstBlockParent(),n=o(t);e.focus(),(t&&!n.is("body")||(e.execCommand("formatBlock","p"),t=e.getRangeHelper().getFirstBlockParent(),n=o(t),t&&!n.is("body")))&&("ltr"===n.css("direction")?n.css("direction",""):n.css("direction","ltr"))},tooltip:"Left-to-Right"},rtl:{state:function(e,t){return t&&"rtl"===t.style.direction},exec:function(){var e=this,t=e.getRangeHelper().getFirstBlockParent(),n=o(t);e.focus(),(t&&!n.is("body")||(e.execCommand("formatBlock","p"),t=e.getRangeHelper().getFirstBlockParent(),n=o(t),t&&!n.is("body")))&&("rtl"===n.css("direction")?n.css("direction",""):n.css("direction","rtl"))},tooltip:"Right-to-Left"},print:{exec:"print",tooltip:"Print"},maximize:{state:function(){return this.maximize()},exec:function(){this.maximize(!this.maximize())},txtExec:function(){this.maximize(!this.maximize())},tooltip:"Maximize",shortcut:"Ctrl+Shift+M"},source:{state:function(){return this.sourceMode()},exec:function(){this.toggleSourceMode()},txtExec:function(){this.toggleSourceMode()},tooltip:"View source",shortcut:"Ctrl+Shift+S"},ignore:{}};return s}.call(t,n,t,e))&&(e.exports=o)},function(e,t,n){var o;void 0!==(o=function(e){"use strict";return{toolbar:"bold,italic,underline,strike,subscript,superscript|left,center,right,justify|font,size,color,removeformat|cut,copy,paste,pastetext|bulletlist,orderedlist,indent,outdent|table|code,quote|horizontalrule,image,email,link,unlink|emoticon,youtube,date,time|ltr,rtl|print,maximize,source",toolbarExclude:null,style:"jquery.sceditor.default.css",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Georgia,Impact,Sans-serif,Serif,Times New Roman,Trebuchet MS,Verdana",colors:"#000,#44B8FF,#1E92F7,#0074D9,#005DC2,#00369B,#b3d5f4|#444,#C3FFFF,#9DF9FF,#7FDBFF,#68C4E8,#419DC1,#d9f4ff|#666,#72FF84,#4CEA5E,#2ECC40,#17B529,#008E02,#c0f0c6|#888,#FFFF44,#FFFA1E,#FFDC00,#E8C500,#C19E00,#fff5b3|#aaa,#FFC95F,#FFA339,#FF851B,#E86E04,#C14700,#ffdbbb|#ccc,#FF857A,#FF5F54,#FF4136,#E82A1F,#C10300,#ffc6c3|#eee,#FF56FF,#FF30DC,#F012BE,#D900A7,#B20080,#fbb8ec|#fff,#F551FF,#CF2BE7,#B10DC9,#9A00B2,#9A00B2,#e8b6ef",locale:n(1)("html").attr("lang")||"en",charset:"utf-8",emoticonsCompat:!1,emoticonsEnabled:!0,emoticonsRoot:"",emoticons:{dropdown:{":)":"emoticons/smile.png",":angel:":"emoticons/angel.png",":angry:":"emoticons/angry.png","8-)":"emoticons/cool.png",":'(":"emoticons/cwy.png",":ermm:":"emoticons/ermm.png",":D":"emoticons/grin.png","<3":"emoticons/heart.png",":(":"emoticons/sad.png",":O":"emoticons/shocked.png",":P":"emoticons/tongue.png",";)":"emoticons/wink.png"},more:{":alien:":"emoticons/alien.png",":blink:":"emoticons/blink.png",":blush:":"emoticons/blush.png",":cheerful:":"emoticons/cheerful.png",":devil:":"emoticons/devil.png",":dizzy:":"emoticons/dizzy.png",":getlost:":"emoticons/getlost.png",":happy:":"emoticons/happy.png",":kissing:":"emoticons/kissing.png",":ninja:":"emoticons/ninja.png",":pinch:":"emoticons/pinch.png",":pouty:":"emoticons/pouty.png",":sick:":"emoticons/sick.png",":sideways:":"emoticons/sideways.png",":silly:":"emoticons/silly.png",":sleeping:":"emoticons/sleeping.png",":unsure:":"emoticons/unsure.png",":woot:":"emoticons/w00t.png",":wassat:":"emoticons/wassat.png"},hidden:{":whistling:":"emoticons/whistling.png",":love:":"emoticons/wub.png"}},width:null,height:null,resizeEnabled:!0,resizeMinWidth:null,resizeMinHeight:null,resizeMaxHeight:null,resizeMaxWidth:null,resizeHeight:!0,resizeWidth:!0,dateFormat:"year-month-day",toolbarContainer:null,enablePasteFiltering:!1,disablePasting:!1,readOnly:!1,rtl:!1,autofocus:!1,autofocusEnd:!0,autoExpand:!1,autoUpdate:!1,spellcheck:!0,runWithoutWysiwygSupport:!1,startInSourceMode:!1,id:null,plugins:"",zIndex:null,bbcodeTrim:!1,disableBlockRemove:!1,parserOptions:{},dropDownCss:{}}}.call(t,n,t,e))&&(e.exports=o)}]),function(e){"use strict";var t=e.sceditor,n=t.plugins,o=t.dom,i={bold:{txtExec:["<strong>","</strong>"]},italic:{txtExec:["<em>","</em>"]},underline:{txtExec:['<span style="text-decoration: underline;">',"</span>"]},strike:{txtExec:['<span style="text-decoration: line-through;">',"</span>"]},subscript:{txtExec:["<sub>","</sub>"]},superscript:{txtExec:["<sup>","</sup>"]},left:{txtExec:['<div style="text-align: left;">',"</div>"]},center:{txtExec:['<div style="text-align: center;">',"</div>"]},right:{txtExec:['<div style="text-align: right;">',"</div>"]},justify:{txtExec:['<div style="text-align: justify;">',"</div>"]},font:{txtExec:function(e){var n=this;t.command.get("font")._dropDown(n,e,function(e){n.insertText('<span style="font-family: '+e+';">',"</span>")})}},size:{txtExec:function(e){var n=this;t.command.get("size")._dropDown(n,e,function(e){n.insertText('<span style="font-size: '+e+';">',"</span>")})}},color:{txtExec:function(e){var n=this;t.command.get("color")._dropDown(n,e,function(e){n.insertText('<span style="color: '+e+';">',"</span>")})}},bulletlist:{txtExec:["<ul><li>","</li></ul>"]},orderedlist:{txtExec:["<ol><li>","</li></ol>"]},table:{txtExec:["<table><tr><td>","</td></tr></table>"]},horizontalrule:{txtExec:["<hr />"]},code:{txtExec:["<code>","</code>"]},image:{txtExec:function(e,t){var n=prompt(this._("Enter the image URL:"),t);n&&this.insertText('<img src="'+n+'" />')}},email:{txtExec:function(e,t){var n,o,i=t&&t.indexOf("@")>-1?null:t;n=prompt(this._("Enter the e-mail address:"),i?"":t),o=prompt(this._("Enter the displayed text:"),i||n)||n,n&&this.insertText('<a href="mailto:'+n+'">'+o+"</a>")}},link:{txtExec:function(e,t){var n=t&&t.indexOf("http://")>-1?null:t,o=prompt(this._("Enter URL:"),n?"http://":t),i=prompt(this._("Enter the displayed text:"),n||o)||o;o&&this.insertText('<a href="'+o+'">'+i+"</a>")}},quote:{txtExec:["<blockquote>","</blockquote>"]},youtube:{txtExec:function(e){var n=this;t.command.get("youtube")._dropDown(n,e,function(e){n.insertText('<iframe width="560" height="315" src="https://www.youtube.com/embed/{id}?wmode=opaque" data-youtube-id="'+e+'" frameborder="0" allowfullscreen></iframe>')})}},rtl:{txtExec:['<div stlye="direction: rtl;">',"</div>"]},ltr:{txtExec:['<div stlye="direction: ltr;">',"</div>"]}};t.XHTMLSerializer=function(){var t,n,i,r,a,s,l,c,u,d,f={indentStr:"\t"},p=[],h=0;t=function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};return e?e.replace(/[&<>"]/g,function(e){return t[e]||e}):""},n=function(e){return e.replace(/[\r\n]/," ").replace(/[^\S|\u00A0]+/g," ")},this.serialize=function(e,t){if(p=[],t)for(e=e.firstChild;e;)i(e),e=e.nextSibling;else i(e);return p.join("")},i=function(e,t){switch(e.nodeType){case 1:"!"===e.nodeName.toLowerCase()?l(e):a(e,t);break;case 3:c(e,t);break;case 4:s(e);break;case 8:l(e);break;case 9:case 11:r(e)}},r=function(e){for(var t=e.firstChild;t;)i(t),t=t.nextSibling},a=function(n,r){var a,s,l,c=n.nodeName.toLowerCase(),f="iframe"===c,p=n.attributes.length,g=n.firstChild,m=r||/pre(?:\-wrap)?$/i.test(e(n).css("whiteSpace")),v=!n.firstChild&&!o.canHaveChildren(n)&&!f;if(!e(n).hasClass("sceditor-ignore")){for(u("<"+c,!r&&d(n));p--;)l=(s=n.attributes[p]).value,u(" "+s.name.toLowerCase()+'="'+t(l)+'"',!1);for(u(v?" />":">",!1),f||(a=g);a;)h++,i(a,m),a=a.nextSibling,h--;v||u("</"+c+">",!m&&!f&&d(n)&&g&&d(g))}},s=function(e){u("<![CDATA["+t(e.nodeValue)+"]]>")},l=function(e){u("\x3c!-- "+t(e.nodeValue)+" --\x3e")},c=function(e,o){var i=e.nodeValue;o||(i=n(i)),i&&u(t(i),!o&&d(e))},u=function(e,t){var n=h;if(!1!==t)for(p.length&&p.push("\n");n--;)p.push(f.indentStr);p.push(e)},d=function(e){var t=e.previousSibling;return 1!==e.nodeType&&t?!o.isInline(t):!t&&!o.isInline(e.parentNode)||!o.isInline(e)}},n.xhtml=function(){var r,a,s,l,c,u,d,f=this,p={},h={};f.init=function(){e.isEmptyObject(n.xhtml.converters||{})||e.each(n.xhtml.converters,function(t,n){e.each(n.tags,function(e){p[e]||(p[e]=[]),p[e].push(n)})}),this.commands=e.extend(!0,{},i,this.commands)},f.signalToSource=function(e,n){return n=n.jquery?n[0]:n,r(n),l(n),u(n),d(n),(new t.XHTMLSerializer).serialize(n,!0)},f.signalToWysiwyg=function(e){return e},f.convertTagTo=o.convertElement,a=function(t,n,o){p[t]&&e.each(p[t],function(i,r){r.tags[t]?e.each(r.tags[t],function(t,i){o.getAttributeNode&&(t=o.getAttributeNode(t))&&(i&&e.inArray(t.value,i)<0||r.conv.call(f,o,n))}):r.conv&&r.conv.call(f,o,n)})},r=function(t){o.traverse(t,function(t){var n=e(t),o=t.nodeName.toLowerCase();a("*",n,t),a(o,n,t)},!0)},s=function(t,n){var i=t.childNodes,r=t.nodeName.toLowerCase(),a=t.nodeValue,l=i.length;if(n&&"br"===r)return!0;if(e(t).hasClass("sceditor-ignore"))return!0;if(!o.canHaveChildren(t))return!1;if(a&&/\S|\u00A0/.test(a))return!1;for(;l--;)if(!s(i[l],n&&!t.previousSibling&&!t.nextSibling))return!1;return!0},l=function(t){o.traverse(t,function(i){var r,a=i.nodeName.toLowerCase(),l=i.parentNode,c=i.nodeType,u=!o.isInline(i),d=i.previousSibling,f=i.nextSibling,p=l===t,h=!d&&!f,g="iframe"!==a&&s(i,p&&h&&"br"!==a),m=i.ownerDocument,v=n.xhtml.allowedTags,y=n.xhtml.disallowedTags;if(3!==c&&(4===c?a="!cdata":"!"!==a&&8!==c||(a="!comment"),g?r=!0:v&&v.length?r=e.inArray(a,v)<0:y&&y.length&&(r=e.inArray(a,y)>-1),r)){if(!g){for(u&&d&&o.isInline(d)&&l.insertBefore(m.createTextNode(" "),i);i.firstChild;)l.insertBefore(i.firstChild,f);u&&f&&o.isInline(f)&&l.insertBefore(m.createTextNode(" "),f)}l.removeChild(i)}},!0)},c=function(t,n){var o={};return t&&e.extend(o,t),n?(e.each(n,function(t,n){e.isArray(n)?o[t]=e.merge(o[t]||[],n):o[t]||(o[t]=null)}),o):o},d=function(t){var n=[],i=function(){n.length&&(e("<p>",t.ownerDocument).insertBefore(n[0]).append(n),n=[])};o.removeWhiteSpace(t);for(var r=t.firstChild;r;)o.isInline(r)&&!e(r).is(".sceditor-ignore")?n.push(r):i(),r=r.nextSibling;i()},u=function(t){var i,r,a,s,l,u,d=n.xhtml.allowedAttribs,f=d&&!e.isEmptyObject(d),p=n.xhtml.disallowedAttribs,g=p&&!e.isEmptyObject(p);h={},o.traverse(t,function(t){if(t.attributes&&(i=t.nodeName.toLowerCase(),s=t.attributes.length))for(h[i]||(h[i]=f?c(d["*"],d[i]):c(p["*"],p[i]));s--;)r=t.attributes[s],a=r.name,l=h[i][a],u=!1,f?u=null!==l&&(!e.isArray(l)||e.inArray(r.value,l)<0):g&&(u=null===l||e.isArray(l)&&e.inArray(r.value,l)>-1),u&&t.removeAttribute(a)})}},n.xhtml.converters=[{tags:{"*":{width:null}},conv:function(e,t){t.css("width",t.attr("width")).removeAttr("width")}},{tags:{"*":{height:null}},conv:function(e,t){t.css("height",t.attr("height")).removeAttr("height")}},{tags:{li:{value:null}},conv:function(e,t){t.removeAttr("value")}},{tags:{"*":{text:null}},conv:function(e,t){t.css("color",t.attr("text")).removeAttr("text")}},{tags:{"*":{color:null}},conv:function(e,t){t.css("color",t.attr("color")).removeAttr("color")}},{tags:{"*":{face:null}},conv:function(e,t){t.css("fontFamily",t.attr("face")).removeAttr("face")}},{tags:{"*":{align:null}},conv:function(e,t){t.css("textAlign",t.attr("align")).removeAttr("align")}},{tags:{"*":{border:null}},conv:function(e,t){t.css("borderWidth",t.attr("border")).removeAttr("border")}},{tags:{applet:{name:null},img:{name:null},layer:{name:null},map:{name:null},object:{name:null},param:{name:null}},conv:function(e,t){t.attr("id")||t.attr("id",t.attr("name")),t.removeAttr("name")}},{tags:{"*":{vspace:null}},conv:function(e,t){t.css("marginTop",t.attr("vspace")-0).css("marginBottom",t.attr("vspace")-0).removeAttr("vspace")}},{tags:{"*":{hspace:null}},conv:function(e,t){t.css("marginLeft",t.attr("hspace")-0).css("marginRight",t.attr("hspace")-0).removeAttr("hspace")}},{tags:{hr:{noshade:null}},conv:function(e,t){t.css("borderStyle","solid").removeAttr("noshade")}},{tags:{"*":{nowrap:null}},conv:function(e,t){t.css("white-space","nowrap").removeAttr("nowrap")}},{tags:{big:null},conv:function(t){e(this.convertTagTo(t,"span")).css("fontSize","larger")}},{tags:{small:null},conv:function(t){e(this.convertTagTo(t,"span")).css("fontSize","smaller")}},{tags:{b:null},conv:function(t){e(this.convertTagTo(t,"strong"))}},{tags:{u:null},conv:function(t){e(this.convertTagTo(t,"span")).css("textDecoration","underline")}},{tags:{s:null,strike:null},conv:function(t){e(this.convertTagTo(t,"span")).css("textDecoration","line-through")}},{tags:{dir:null},conv:function(e){this.convertTagTo(e,"ul")}},{tags:{center:null},conv:function(t){e(this.convertTagTo(t,"div")).css("textAlign","center")}},{tags:{font:{size:null}},conv:function(e,t){var n=t.css("fontSize");"+0"!==n&&t.css("fontSize",n),t.removeAttr("size")}},{tags:{font:null},conv:function(e){this.convertTagTo(e,"span")}},{tags:{"*":{type:["_moz"]}},conv:function(e,t){t.removeAttr("type")}},{tags:{"*":{_moz_dirty:null}},conv:function(e,t){t.removeAttr("_moz_dirty")}},{tags:{"*":{_moz_editor_bogus_node:null}},conv:function(e,t){t.remove()}}],n.xhtml.allowedAttribs={},n.xhtml.disallowedAttribs={},n.xhtml.allowedTags=[],n.xhtml.disallowedTags=[]}(jQuery);